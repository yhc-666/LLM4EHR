Epoch 0:   0%|                                                                                                                  | 0/5791 [00:00<?, ?it/s]/home/ubuntu/hcy50662/LLM4EHR/src/data/collate.py:35: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ./torch/csrc/utils/tensor_new.cpp:254.)
  labels_tensor = torch.tensor(labels, dtype=torch.float32)
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 5791/5791 [1:40:23<00:00,  1.04s/it, loss=0.43]
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 1270/1270 [06:36<00:00,  3.20it/s]
{'macro_AUROC': '0.8180', 'macro_AUPRC': '0.5332', 'micro_F1': '0.5068', 'macro_F1': '0.4358'}
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 5791/5791 [1:40:29<00:00,  1.04s/it, loss=0.463]
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 1270/1270 [06:54<00:00,  3.07it/s]
{'macro_AUROC': '0.8385', 'macro_AUPRC': '0.5747', 'micro_F1': '0.5462', 'macro_F1': '0.4724'}
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 5791/5791 [1:40:28<00:00,  1.04s/it, loss=0.306]
Validation: 100%|██████████████████████████████████████████| 1270/1270 [06:37<00:00,  3.20it/s]
{'macro_AUROC': '0.8447', 'macro_AUPRC': '0.5852', 'micro_F1': '0.5462', 'macro_F1': '0.4854'}
Epoch 3: 100%|███████████████████████████████| 5791/5791 [1:40:24<00:00,  1.04s/it, loss=0.466]
Validation: 100%|██████████████████████████████████████████| 1270/1270 [06:35<00:00,  3.21it/s]
{'macro_AUROC': '0.8477', 'macro_AUPRC': '0.5956', 'micro_F1': '0.5429', 'macro_F1': '0.5013'}
Epoch 4: 100%|███████████████████████████████| 5791/5791 [1:40:21<00:00,  1.04s/it, loss=0.219]
Validation: 100%|██████████████████████████████████████████| 1270/1270 [06:36<00:00,  3.20it/s]
{'macro_AUROC': '0.8489', 'macro_AUPRC': '0.5970', 'micro_F1': '0.5608', 'macro_F1': '0.5143'}
